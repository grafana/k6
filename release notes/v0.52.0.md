k6 `v0.52.0` is here ðŸŽ‰! This release includes:

- (_optional_) `<highlight of breaking changes>`
- `<Summary of new features>` (_one or multiple bullets_)


## Breaking changes

- [`#3777`](https://github.com/grafana/k6/pull/3777) removes panic handling in k6. Previously, k6 tried to recover and continue execution. Unfortunately, this isn't always successful and could lead to unexpected behavior. Now, k6 will always exit on panic. Panic itself should be fixed separately.
- [browser#1318](https://github.com/grafana/xk6-browser/pull/1318) The `up` and `down` methods no longer take x and y coordinates. Instead, they dispatch events on the current mouse position.

- `#pr`, `<small_break_2>`

### (_optional h3_) `<big_breaking_change>` `#pr`

## New features

_optional intro here_

### `<big_feature_1>` `#pr`

_what, why, and what this means for the user_

### `<big_feature_n>` `#pr`

_what, why, and what this means for the user_

### `k6/browser` has graduated from an experimental module #3793

The browser module is now available as `k6/browser` instead of `k6/experimental/browser`. The previous `k6/experimental/browser` module will be removed on September 23rd, 2024. Please see [the migration guide](https://grafana.com/docs/k6/latest/using-k6-browser/migrating-to-k6-v0-52/) for more information on how to update your scripts.

### `k6/browser` has now a fully Async API [browser#428](https://github.com/grafana/xk6-browser/issues/428)

This release introduces a fully Async API for the `k6/browser` module. This means that nearly all the methods in the module now return promises. This change is part of the ongoing effort to make the browser module more user-friendly and easier to use. Please see [the browser documentation](https://grafana.com/docs/k6/latest/javascript-api/k6-browser) for more information on how to use the new Async API.

Related Changes:
- [browser#1310](https://github.com/grafana/xk6-browser/pull/1310), [browser#1311](https://github.com/grafana/xk6-browser/pull/1311), [browser#1312](https://github.com/grafana/xk6-browser/pull/1312), [browser#1316](https://github.com/grafana/xk6-browser/pull/1316) Migrate `Browser` APIs to async.
- [browser#1326](https://github.com/grafana/xk6-browser/pull/1326), [browser#1327](https://github.com/grafana/xk6-browser/pull/1327), [browser#1328](https://github.com/grafana/xk6-browser/pull/1328) Migrate `BrowserContext` APIs to async.
- [browser#1335](https://github.com/grafana/xk6-browser/pull/1335), [browser#1337](https://github.com/grafana/xk6-browser/pull/1337) Migrate `ElementHandle` APIs to async.
- [browser#1367](https://github.com/grafana/xk6-browser/pull/1367) Migrate `Frame` APIs to async.
- [browser#1365](https://github.com/grafana/xk6-browser/pull/1365), [browser#1366](https://github.com/grafana/xk6-browser/pull/1366) Migrate `JSHandle` APIs to async.
- [browser#1313](https://github.com/grafana/xk6-browser/pull/1313), [browser#1314](https://github.com/grafana/xk6-browser/pull/1314) Migrate `Keyboard` APIs to async.
- [browser#1330](https://github.com/grafana/xk6-browser/pull/1330), [browser#1332](https://github.com/grafana/xk6-browser/pull/1332) Migrate `Locator` APIs to async.
- [browser#1322](https://github.com/grafana/xk6-browser/pull/1322), [browser#1323](https://github.com/grafana/xk6-browser/pull/1323) Migrate `Mouse` APIs to async.
- [browser#1343](https://github.com/grafana/xk6-browser/pull/1343), [browser#1345](https://github.com/grafana/xk6-browser/pull/1345), [browser#1352](https://github.com/grafana/xk6-browser/pull/1352), [browser#1355](https://github.com/grafana/xk6-browser/pull/1355) Migrate `Page` APIs to async.
- [browser#1348](https://github.com/grafana/xk6-browser/pull/1348), [browser#1349](https://github.com/grafana/xk6-browser/pull/1349), [browser#1354](https://github.com/grafana/xk6-browser/pull/1354), [browser#1358](https://github.com/grafana/xk6-browser/pull/1358), [browser#1363](https://github.com/grafana/xk6-browser/pull/1363) Migrate `Request` APIs to async.
- [browser#1364](https://github.com/grafana/xk6-browser/pull/1364) Migrate `Response` APIs to async.

## UX improvements and enhancements

_Format as `<number> <present_verb> <object>. <credit>`_:

- [#3798](https://github.com/grafana/k6/pull/3798) adjusts a severity level of a log message from `warn` to `debug` for cases when k6 can't detect the terminal's size.
- [browser#1370](https://github.com/grafana/xk6-browser/issues/1370) The `GetAttribute` methods now return `false` when the attribute is missing, making it easier to check for the presence of an attribute.
- [browser#1371](https://github.com/grafana/xk6-browser/issues/1371) The `TextContent` methods now return `false` when the element's text content cannot be grabbed (like a JS `document`), making it easier to check for the presence of text content.
- [browser#1376](https://github.com/grafana/xk6-browser/pull/1376) Makes `Request.headerValue` and `Response.headerValue` to be case insensitive.
- [browser#1368](https://github.com/grafana/xk6-browser/pull/1368) Enhances `await` usage in Javascript examples.

## Bug fixes

- [#3776](https://github.com/grafana/k6/pull/3776) fixes a panic caused by passing an undefined handler to timers.
- [#3779](https://github.com/grafana/k6/pull/3779) fixes a panic caused by registering an undefined handler in gRPC streams.
- [xk6-websockets#73](https://github.com/grafana/xk6-websockets/pull/73) fixes a panic caused by registering an undefined handler in WebSockets.
- [browser#1369](https://github.com/grafana/xk6-browser/pull/1369) Improves `valueFromRemoteObject` `null` detection by returning a Go `nil` instead of `"null"` as a `string`.
- [browser#1386](https://github.com/grafana/xk6-browser/pull/1386) Correctly handles empty string flags that don't have a value.
- [browser#1380](https://github.com/grafana/xk6-browser/pull/1380) Ensures that `JSHandle.evaluate` and `JSHandle.evaluateHandle` both set themselves as the first argument.
- [browser#1346](https://github.com/grafana/xk6-browser/pull/1346) Fixes an IFrame panic ("we either navigate top level or have old version of the navigated frame") that happens during navigation.
- [browser#1334](https://github.com/grafana/xk6-browser/pull/1334) Fixes an issue where clicking on a link that opens a new tab never navigates to the href link.
- [browser#1318](https://github.com/grafana/xk6-browser/pull/1318) Fixes the `Mouse.move` to correctly dispatch a `down` event.
- [browser#1301](https://github.com/grafana/xk6-browser/pull/1301) Fixes an error that occurs when working with a second tab and navigating to a URL.
- [browser#1301](https://github.com/grafana/xk6-browser/pull/1301) Fixes an error that occurs when working with a second tab and navigating to a URL.

## Maintenance and internal improvements

_Format as `<number> <present_verb> <object>. <credit>`_:
- _`#2770` Refactors parts of the JS module._

- [browser#1298](https://github.com/grafana/xk6-browser/pull/1298) Splits browser mappings into separate files for better organization and maintainability.
- [browser#1321](https://github.com/grafana/xk6-browser/pull/1321) Adds test helpers for async VU execution to reduce the boilerplate in the tests.
- [browser#1357](https://github.com/grafana/xk6-browser/pull/1357) Updates `Group` and `Tag` usage for the latest k6.
- [browser#1361](https://github.com/grafana/xk6-browser/pull/1361) Precalculates the browser version information to prevent I/O calls when the `version` and `userAgent` methods are called. This change allows the browser module to expose these methods as a sync API to be consistent with the Playwright's API.
- [browser#1360](https://github.com/grafana/xk6-browser/pull/1360), [browser#1327](https://github.com/grafana/xk6-browser/pull/1327), [browser#1335](https://github.com/grafana/xk6-browser/pull/1335), [browser#1365](https://github.com/grafana/xk6-browser/pull/1365), [browser#1313](https://github.com/grafana/xk6-browser/pull/1313), [browser#1322](https://github.com/grafana/xk6-browser/pull/1322), [browser#1330](https://github.com/grafana/xk6-browser/pull/1330), [browser#1343](https://github.com/grafana/xk6-browser/pull/1343), [browser#1345](https://github.com/grafana/xk6-browser/pull/1345), [browser#1352](https://github.com/grafana/xk6-browser/pull/1352) Turns the `Browser`, `BrowserContext`, `ElementHandle`, `JSHandle`, `Keyboard`, `Mouse`, `Locator`, and `Page` classes' panics into errors for stability and better error handling.
- [browser#1377](https://github.com/grafana/xk6-browser/pull/1377) Uses the Goja fork called Sobek in the browser module.
- [browser#1373](https://github.com/grafana/xk6-browser/pull/1373) Provides sync and async APIs within the browser module for making the migration to the async API easier.

## Roadmap

### OpenTelemetry metrics output

We're also happy to share that this release cycle, we've been working on [xk6-output-opentelemetry](https://github.com/grafana/xk6-output-opentelemetry/), a k6 output extension that allows you to send k6 metrics to OpenTelemetry-compatible backends. We're looking for feedback from the community. If you're interested, please try it and let us know [via the extension repository](https://github.com/grafana/xk6-output-opentelemetry/issues)!

Depending on the feedback, we plan to include this extension as an experimental output in the next K6 release.
