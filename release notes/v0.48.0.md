k6 v0.48.0 is here ðŸŽ‰! This release includes:

- (_optional_) `<highlight of breaking changes>`
- `<Summary of new features>` (_one or multiple bullets_)

## Breaking changes

- [#3350](https://github.com/grafana/k6/pull/3350) In k6 [v0.37](https://github.com/grafana/k6/releases/tag/v0.37.0), we deprecated a gRPC Invoke's parameter `headers`. This release removes the parameter. If you need to set headers, use a `metadata` parameter instead.
- [#3448](https://github.com/grafana/k6/pull/3448) metric names now need to conform to both otel and prometheus name requirements while still being limitted to 128 characters (old k6 limit).
- [#3451](https://github.com/grafana/k6/pull/3451) In k6 [v0.25](https://github.com/grafana/k6/releases/tag/v0.25.0) module specifiers were allowed to be urls with scheme, and k6 prepending `https://` to anything that it wasn't recognizing was deprecated. From this version k6 will no longer try to do that all, please use full URLs if you want to load remote modules.

### Redis (m)TLS support and new Client constructor options [`xk6-redis/#17`](https://github.com/grafana/xk6-redis/pull/17)

In this release, the `k6/experimental/redis`` module receives several important changes, including breaking updates.

#### Connection URLs

The `Client` constructor now supports connection URLs to configure connections to Redis servers or clusters. These URLs can be in the format `redis://[[username][:password]@][host][:port][/db-number]` for standard connections, or `rediss://[[username][]:password@]][host][:port][/db-number]` for TLS-secured connections. For more details, see the [documentation](https://grafana.com/docs/k6/latest/javascript-api/k6-experimental/redis/).

##### Example usage

```javascript
import redis from 'k6/experimental/redis';

const redisClient = new redis.Client('redis://someusername:somepassword@localhost:6379/0');
```

#### Revamped Options object

The `Client` constructor has been updated with a new [Options](https://grafana.com/docs/k6/latest/javascript-api/k6-experimental/redis/redis-options/) object format. This change aligns the module with familiar patterns from NodeJS and Deno libraries, offering enhanced flexibility and control over Redis connections. Detailed information is available in the [documentation](https://grafana.com/docs/k6/latest/javascript-api/k6-experimental/redis/redis-options/).

##### Example usage

```javascript
import redis from 'k6/experimental/redis';

const redisClient = new redis.Client({
  socket: {
    host: 'localhost',
    port: 6379,
  },
  username: 'someusername',
  password: 'somepassword',
});
```

#### (m)TLS support

The module now includes (m)TLS support, enhancing security for connections. This update also improves support for Redis clusters and sentinel modes (failover). For connections using self-signed certificates, enable k6's [insecureSkipTLSVerify](https://grafana.com/docs/k6/latest/using-k6/k6-options/reference/#insecure-skip-tls-verify) option (set to `true`).

##### Example usage
```javascript
import redis from 'k6/experimental/redis';

const redisClient = new redis.Client({
  socket: {
    host: 'localhost',
    port: 6379,
    tls: {
      ca: [open('ca.crt')],
      cert: open('client.crt'), // client certificate
      key: open('client.key'), // client private key
    },
  },
});
```

## New features

### Add `k6 new` subcommand [#3394](https://github.com/grafana/k6/pull/3394)

`k6` now has a `new` subcommand that can be used to generate a new test script. This is useful for new users who want to get started quickly, or for experienced users who want to save time when creating new test scripts. The subcommand can be used like this:

```bash
k6 new [filename]
```

If no filename is provided, the default filename `script.js` will be used. The subcommand will create a new file with the provided name in the current directory, and populate it with a basic test script that can be run with `k6 run`.

## UX improvements and enhancements

- [browser#1074](https://github.com/grafana/xk6-browser/pull/1074) Adds a new `browser.closeContext()` [method](https://k6.io/docs/javascript-api/k6-experimental/browser/closecontext/) to facilitate closing the current active browser context.
- [#3370](https://github.com/grafana/k6/pull/3370). The k6 got a new flag `--profiling-enabled` which enables exposing [pprof](https://go.dev/blog/pprof) profiling endpoints. The profiling endpoints are exposed on the same port as the HTTP REST API under the `/debug/pprof/` path. This could be useful for the extension developers.
- [#3442](https://github.com/grafana/k6/pull/3442). The k6 now supports a new `--version` flag. It has the same output as `k6 version` command. Thanks, @ffapitalle!
- [#3423](https://github.com/grafana/k6/pull/3423). The InfluxDB output got an environment variable `K6_INFLUXDB_PROXY` which allows specifying proxy. Thanks, @IvanovOleg!

## Bug fixes

- [#3380](https://github.com/grafana/k6/pull/3380) Output message to the `--console-output` file at the same level as it would to stdout. This makes `-v` work in the same way for both.
- [#3416](https://github.com/grafana/k6/pull/3416) Prints the stack trace when there's an exception in `handleSummary()`.
- [#3438](https://github.com/grafana/k6/pull/3438) Don't error on http requests with content-encoding and http statuses known for having no body.
- [browser#1077](https://github.com/grafana/xk6-browser/pull/1077) Fixes `browserContext.clearPermissions` to clear permissions without panic.
- [browser#1042](https://github.com/grafana/xk6-browser/pull/1042) Fixes `browserContext.waitForEvent` which involved promisifying the `waitForEvent` API.
- [browser#1078](https://github.com/grafana/xk6-browser/pull/1078) Fixes request interception deadlock to improve stability.

## Maintenance and internal improvements

- [#3378](https://github.com/grafana/k6/pull/3378) Fix usage of `gh` in GitHub actions creating the OSS release.
- [#3386](https://github.com/grafana/k6/pull/3386), [#3387](https://github.com/grafana/k6/pull/3387), [#3388](https://github.com/grafana/k6/pull/3388) k6 dependencies updates.
- [#3393](https://github.com/grafana/k6/pull/3393) Fix lint issues in the `js` package.
- [#3397](https://github.com/grafana/k6/pull/3397) The `goja` dependency update. Fixed a possible panic at `JSON.stringify`.
- [#3381](https://github.com/grafana/k6/pull/3381) We temporarily disabled ARM tests on GitHub Actions.
- [#3401](https://github.com/grafana/k6/pull/3401) A Makefile refactoring, `make ci-like-lint` was removed in favor of `make lint`. The golangci-lint version updated to v1.54.2.
- [#3410](https://github.com/grafana/k6/pull/3410) Fixed the `tests` reference in the all rule of the Makefile. Thanks, @flyck!
- [#3402](https://github.com/grafana/k6/pull/3402) Additional test-case for the `k6 cloud`.
- [#3421](https://github.com/grafana/k6/pull/3421) Update dependencies for xk6 integration tests.
- [browser#1075](https://github.com/grafana/xk6-browser/pull/1075), [browser#1076](https://github.com/grafana/xk6-browser/pull/1076) Refactors `clearPermissions` and `grantPermissions`.
- [browser#1043](https://github.com/grafana/xk6-browser/pull/1043) Refine tests.
- [browser#1047](https://github.com/grafana/xk6-browser/pull/1047) Update dependencies.
- [browser#1069](https://github.com/grafana/xk6-browser/pull/1069), [browser#1090](https://github.com/grafana/xk6-browser/pull/1090) Internal refactors.
- [#3443](https://github.com/grafana/k6/pull/3443). We explicitly mentioned that we aim to support the last two major golang versions for building a k6 binary.

## _Optional_ Roadmap

_Discussion of future plans_

